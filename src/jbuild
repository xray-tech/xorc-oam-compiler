(library
 ((name orcml)
  (public_name orcml)
  (libraries (base menhirLib sedlex stdio msgpck sexplib yojson mtime.clock.os))
  (preprocess (pps (ppx_jane)))
  (flags (:standard -w -9 -w -39))
))

(rule
 ((targets (lexer.ml))
  (deps    (lexer.sedlex.ml))
  (action  (run ${lib:sedlex:ppx_sedlex} ${<} -o ${@}))))

(rule
 ((targets (parser_messages.ml))
  (deps    (parser.mly handcrafted.messages))
  (action  (with-stdout-to ${@} (run menhir parser.mly --compile-errors handcrafted.messages)))))

(menhir
 ((flags (--explain --dump --table))
  (modules (parser))))

(jbuild_version 1)
